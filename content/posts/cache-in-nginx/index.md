---
title: "Как включить кэширование открытых файлов в Nginx"
date: 2024-07-25
description: "NGINX — это высокопроизводительный веб-сервер с множеством функций для оптимизации производительности и эффективности сервера. Одной из таких функций является кэш открытых файлов, который помогает повысить производительность за счет кэширования информации об открытых файлах. Это сокращает количество системных вызовов, необходимых для доступа к информации о файлах, что приводит к сокращению времени отклика и снижению нагрузки на сервер. Включение кэша открытых файлов в NGINX может значительно повысить производительность вашего веб-сервера, особенно в условиях высокой нагрузки."
tags: ["NGINX", "Linux"]
type: post
weight: 20
showTableOfContents: true
---
## Включить кэширование открытых файлов в Nginx
### Доступ к файлу конфигурации Nginx
Чтобы включить Open File Cache, начните с доступа к файлу конфигурации Nginx. Этот файл обычно находится в `/etc/nginx/nginx.conf`. Откройте его с помощью текстового редактора, например Nano:
```
sudo nano /etc/nginx/nginx.conf
```
### Настройка кэширования открытых файлов в Nginx
Вставьте в файл конфигурации следующие директивы для включения кэша открытых файлов:
```
open_file_cache max=10000 inactive=10s;
open_file_cache_valid 60s;
open_file_cache_min_uses 2;
open_file_cache_errors on;
```
### Пример конфигурации открытого файлового кэша в Nginx
Ниже приведен пример, демонстрирующий эти настройки в стандартной конфигурации Nginx:
```
http {
    open_file_cache max=10000 inactive=10s;
    open_file_cache_valid 60s;
    open_file_cache_min_uses 2;
    open_file_cache_errors on;

    server {
        listen 80;
        server_name example.com;

        location / {
            root /var/www/example.com;
            index index.html;
        }
    }
}
```
После включения этих настроек обязательно сохраните изменения в текстовом редакторе nano, нажав CTRL+X, затем подтвердите сохранение, нажав Y. После этого выйдите из редактора.

### Понимание кэша открытых файлов в конфигурации Nginx
Каждая строка в приведенной выше конфигурации играет решающую роль:

- **Максимальный размер кэша и период бездействия:** open_file_cache max=10000 inactive=10 с; задает максимальное количество файловых дескрипторов для кэширования (10 000) и указывает продолжительность (10 секунд), по истечении которой неактивные файлы удаляются из кэша.
- **Период действия кэшированных файлов:** open_file_cache_valid 60s определяет, как долго кэшированные файлы остаются действительными. Здесь он установлен на 60 секунд.
- **Минимальное использование кэширования:** open_file_cache_min_uses 2; это определяет минимальное количество обращений к файлу перед его кэшированием, в этом примере оно равно 2.
- **Кэширование ошибок файлов:** open_file_cache_errors включено; позволяет кэшировать дескрипторы файлов, даже если открытие файла приводит к ошибкам, что повышает эффективность обработки ошибок.
Эти конфигурации предлагают сбалансированный подход, оптимизируя кэширование файлов при сохранении производительности сервера.

### Проверка и перезапуск Nginx
Прежде чем внедрять эти изменения в рабочую среду, проверьте правильность конфигурации:
```
nginx -t
```
После успешной реализации должен быть отображен следующий результат:
```
nginx: configuration file /etc/nginx/nginx.conf test is successful
```
Наконец, перезапустите сервер Nginx, чтобы изменения вступили в силу:
```
sudo systemctl restart nginx
```
## Заключение
Включив кэш открытых файлов в NGINX, вы можете улучшить время отклика и общую производительность вашего сервера. Регулярно отслеживайте результаты этой конфигурации, чтобы убедиться, что она обеспечивает желаемые преимущества, и корректируйте настройки по мере необходимости. Внедрение кэша открытых файлов — это мощный способ оптимизации NGINX, делая ваш веб-сервер более эффективным и способным обрабатывать более высокие объемы трафика.