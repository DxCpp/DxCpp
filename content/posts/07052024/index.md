---
title: "Как изменить порты в Nginx"
date: 2024-05-07
description: "Изменение портов в Nginx, будь то в целях безопасности, разрешения конфликтов или для нужд инфраструктуры, может показаться сложной задачей, но на самом деле это довольно просто, если знать последовательность действий."
tags: ["NGINX", "Linux"]
type: post
weight: 20
showTableOfContents: true
---
## Вот почему важно научиться менять порт в Nginx:

Гибкость и безопасность : настройка портов повышает безопасность за счет снижения уязвимости к атакам на порты по умолчанию.
Разрешение конфликтов : предотвращает конфликты с другими службами, работающими на порту по умолчанию, обеспечивая более плавную работу сервера.
Индивидуальная конфигурация : обеспечивает лучший контроль над архитектурой сервера, соответствуя конкретным потребностям проекта или организации.
Расширение знаний : углубляет ваши общие познания в области Linux и управления серверами.
Далее мы покажем вам, как изменить порт Nginx в Linux, настроив файлы конфигурации и изучив необходимые сведения о сети и порте.

### Понимание основ настройки портов Nginx
#### Расположение файла конфигурации Nginx в дистрибутивах Linux
Для эффективного управления Nginx в различных дистрибутивах Linux важно знать, где находится его файл конфигурации. В системах Ubuntu и Debian этот файл обычно находится в `/etc/nginx/nginx.conf`. Напротив, CentOS и Fedora следуют схожему пути. Важно отметить, что если Nginx скомпилирован из исходного кода или установлен с помощью альтернативного менеджера пакетов, файл конфигурации может находиться в `/usr/local/nginx/conf/` или `/opt/nginx/conf/`. Определение правильного пути к файлу является ключевым шагом в настройке Nginx.

### Изменить синтаксис конфигурации порта Nginx
Директива `listen` играет центральную роль в изменении порта, на котором работает Nginx, и обычно находится в блоке server. По умолчанию Nginx настроен на прослушивание порта 80 для HTTP-подключений и порта 443 для HTTPS-подключений.

### Примеры основных конфигураций портов
#### Изменение на один альтернативный порт:
Чтобы переключиться на альтернативный порт, например 8080, используйте следующую конфигурацию:
```
server {
    listen 8080;
    ...
}
```
#### Установка определенного IP-адреса и порта:
Для привязки Nginx к определенному IP-адресу и порту, например, IP-адресу 192.168.1.10и порту 8000, выполните следующую настройку:
```
server {
    listen 192.168.1.10:8000;
    ...
}
```
#### Конфигурация IPv6:
Чтобы настроить Nginx для прослушивания IPv6-адреса на порту 8080:
```
server {
    listen [::]:8080;
    ...
}
```
#### Прослушивание нескольких портов:
Чтобы настроить Nginx для прослушивания нескольких портов, например 8080 и 8081:
```
server {
    listen 8080;
    listen 8081;
    ...
}
```
### Настройка сервера по умолчанию для определенного порта:
Чтобы сделать Nginx сервером по умолчанию для определенного порта, например 8080, используйте:
```
server {
    listen 8080 default_server;
    ...
}
```
### Прослушивание нескольких портов IPv6:
Для базовой конфигурации, где Nginx прослушивает несколько портов IPv6, настройка аналогична IPv4. Например, прослушивание портов 8080 и 8081:
```
server {
    listen [::]:8080;
    listen [::]:8081;
    ...
}
```
Приведенные примеры закладывают основу для понимания и внедрения основных конфигураций портов в Nginx. Двигаясь вперед, мы углубимся в дополнительные примеры, стремясь детализировать их для более сложных вариантов использования.

## Дополнительные примеры изменения конфигурации порта Nginx
### Настройка Nginx для HTTP и HTTPS на пользовательских портах
Чтобы настроить Nginx для обработки трафика HTTP и HTTPS на нестандартных портах в Linux, измените конфигурацию для прослушивания нужных портов. Например, используя порты 8080 для HTTP и 8443 для HTTPS:
```
server {
    listen 80;
    listen 443 ssl;
    ssl_certificate /path/to/cert.crt;
    ssl_certificate_key /path/to/key.key;
    ...
}
```
### Перенаправление трафика с пользовательского HTTP-порта на HTTPS
Для повышения безопасности перенаправьте трафик с пользовательского порта HTTP, например 8080, на пользовательский порт HTTPS, например 8443. Это гарантирует шифрование всего трафика:
```
server {
    listen 80;
    server_name example.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl;
    server_name example.com;
    ...
}
```
#### Настройка SSL на нестандартном порту
Чтобы настроить SSL на нестандартном порту в Linux, например 8443, измените конфигурацию Nginx следующим образом:
```
server {
    listen 8443 ssl;
    ssl_certificate /path/to/cert.crt;
    ssl_certificate_key /path/to/key.key;
    ...
}
```
### Размещение нескольких сайтов на разных пользовательских портах
Чтобы разместить несколько веб-сайтов на разных пользовательских портах на сервере Linux, настройте отдельные серверные блоки в Nginx, каждый из которых будет прослушивать уникальный порт:
```
server {
    listen 8080;
    server_name example1.com;
    ...
}

server {
    listen 8081;
    server_name example2.com;
    ...
}
```
### Включение IPv6 на пользовательских портах в Linux
Для сервера Linux, поддерживающего как IPv6, так и IPv4, настройте Nginx для прослушивания пользовательских портов для обоих протоколов:
```
server {
    listen [::]:80 ipv6only=on;
    listen 80;
    ...
}
```
### Расширенная балансировка нагрузки на пользовательских портах
Реализуйте балансировку нагрузки в Nginx на сервере Linux, распределив входящий трафик между несколькими внутренними серверами на настраиваемых портах:
```
upstream backend {
    server backend1.example.com:8080;
    server backend2.example.com:8081;
}

server {
    listen 80;
    location / {
        proxy_pass http://backend;
        ...
    }
}
```